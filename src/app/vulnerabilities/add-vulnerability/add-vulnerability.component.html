<app-alerts></app-alerts>
<clr-tabs class="tabs-vertical">
    <clr-tab>
      <button clrTabLink>Info<span style="color:red">*</span></button>
      <ng-template [(clrIfActive)]="infoActive">
        <clr-tab-content>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-input-container>
                <label>Name<span style="color:red">*</span></label>
                <input autocomplete="off" type="text" name="name" [(ngModel)]="newElement.name" clrInput
                  placeholder="Vulnerability's name" required/>
                  <clr-control-error>This field is required!</clr-control-error>
              </clr-input-container>
            </div>
            <div class="clr-col-lg-auto">
              <clr-select-container class="clr-col-2">
                <label>Status<span style="color:red">*</span></label>
                <select clrSelect class="clr-select" name="status" [(ngModel)]="newElement.status">
                  <option [ngValue]="status.value" *ngFor="let status of _vulnerabilityStatus">{{status.name}}
                  </option>
                </select>
              </clr-select-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto" style="z-index:9999">
              <clr-date-container style="z-index:9999">
                <label>Discovery date<span style="color:red">*</span></label>
                <input type="date" style="z-index:9999" [(clrDate)]="newElement.discoveryDate" name="discoveryDate"
                  >
              </clr-date-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto" style="z-index:9999">
              <clr-date-container style="z-index:9999">
                <label>Mitigation date</label>
                <input type="date" style="z-index:9999" [(clrDate)]="newElement.mitigationDate" name="mitigationDate">
              </clr-date-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto" style="z-index:9999">
              <clr-date-container style="z-index:9999">
                <label>Resolution date</label>
                <input type="date" style="z-index:9999" [(clrDate)]="newElement.resolutionDate" name="resolutionDate">
              </clr-date-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-datalist-container>
                <label>Auditor</label>
                <input clrDatalistInput name="auditor" [(ngModel)]="auxAuditor"
                  (change)="setAuditor($event.target.value)" />
                <datalist>
                  <option *ngFor="let user of users" [value]="user.name"></option>
                </datalist>
              </clr-datalist-container>
            </div>
            <div class="clr-col-lg-auto">
              <clr-datalist-container>
                <label>Responsable</label>
                <input clrDatalistInput name="responsable" [(ngModel)]="auxResponsable"
                  (change)="setResponsable($event.target.value)" />
                <datalist>
                  <option *ngFor="let responsable of contacts" [value]="responsable.name"></option>
                </datalist>
              </clr-datalist-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-datalist-container>
                <label>Audits</label>
                <input clrDatalistInput name="audit" [(ngModel)]="auxAudit"
                  (change)="setAudit($event.target.value)" />
                <datalist>
                  <option *ngFor="let audit of audits" [value]="audit.name"></option>
                </datalist>
              </clr-datalist-container>
            </div>
            <div class="clr-col-lg-auto">
              <clr-datalist-container>
                <label>Asset<span style="color:red">*</span></label>
                <input clrDatalistInput name="asset" [(ngModel)]="auxAsset"
                  (change)="setAsset($event.target.value)" />
                <datalist>
                  <option *ngFor="let asset of assets" [value]="asset.name"></option>
                </datalist>
              </clr-datalist-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-input-container>
                <label>Ticket</label>
                <input autocomplete="off" type="text" name="name" [(ngModel)]="newElement.ticket" clrInput />
              </clr-input-container>
            </div>
            <div class="clr-col-lg-auto">
              <clr-select-container class="clr-col-2">
                <label>Source<span style="color:red">*</span></label>
                <select clrSelect class="clr-select" name="source" [(ngModel)]="newElement.source">
                  <option value="{{source.value}}" *ngFor="let source of _sources">{{source.name}}</option>
                </select>
              </clr-select-container>
            </div>
          </div>
          <button (click)="create()" class="btn btn-outline">Add Vulnerability</button>
        </clr-tab-content>
      </ng-template>
    </clr-tab>
    <clr-tab>
      <button clrTabLink>Risk calculator</button>
      <ng-template [(clrIfActive)]="riskActive">
        <clr-tab-content>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-select-container class="clr-col-2">
                <label>Risk<span style="color:red">*</span></label>
                <select clrSelect class="clr-select" name="risk" [(ngModel)]="newElement.risk">
                  <option [ngValue]="risk" *ngFor="let risk of _vulnerabilityRisk">{{risk}}</option>
                </select>
              </clr-select-container>
            </div>
          </div>
          <br />
          <div class="clr-row">
            <clr-stack-view>
              <clr-stack-header>CVSS</clr-stack-header>
              <clr-stack-block [clrStackViewLevel]="1" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                <clr-stack-label>Base Score</clr-stack-label>
                <clr-stack-content>
                  <span class="badge badge-success"
                    *ngIf="baseScore.rating == 'Low'"><b>{{baseScore.rating}}</b></span>
                  <span class="badge badge-warning"
                    *ngIf="baseScore.rating == 'Medium'"><b>{{baseScore.rating}}</b></span>
                  <span class="badge badge-danger"
                    *ngIf="baseScore.rating == 'High'"><b>{{baseScore.rating}}</b></span>
                  <span class="badge badge-purple"
                    *ngIf="baseScore.rating == 'Critical'"><b>{{baseScore.rating}}</b></span>
                </clr-stack-content>
                <clr-stack-content><span [ngClass]="getClass(totalScore.rating)"><b>{{totalScore.rating}}</b></span>
                </clr-stack-content>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="1">
                  <clr-stack-label>Attack Vector</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackvector" value="AV:N"
                          [(ngModel)]="newElement.cvssAttackvector" />
                        <label>Network (AV:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackvector" value="AV:A"
                          [(ngModel)]="newElement.cvssAttackvector" />
                        <label>Adjacent Network (AV:A)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackvector" value="AV:L"
                          [(ngModel)]="newElement.cvssAttackvector" />
                        <label>Local (AV:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackvector" value="AV:P"
                          [(ngModel)]="newElement.cvssAttackvector" />
                        <label>Physical (AV:P)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Attack complexity</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackcomplexity"
                          value="AC:L" [(ngModel)]="newElement.cvssAttackcomplexity" />
                        <label>Low (AC:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAttackcomplexity"
                          value="AC:H" [(ngModel)]="newElement.cvssAttackcomplexity" />
                        <label>High (AC:H)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Privileges required</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssPrivilegesrequired"
                          value="PR:N" [(ngModel)]="newElement.cvssPrivilegesrequired" />
                        <label>None (PR:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssPrivilegesrequired"
                          value="PR:L" [(ngModel)]="newElement.cvssPrivilegesrequired" />
                        <label>Low (PR:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssPrivilegesrequired"
                          value="PR:H" [(ngModel)]="newElement.cvssPrivilegesrequired" />
                        <label>High (PR:H)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>User interacion</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssUserinteraction"
                          value="UI:N" [(ngModel)]="newElement.cvssUserinteraction" />
                        <label>None (UI:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssUserinteraction"
                          value="UI:R" [(ngModel)]="newElement.cvssUserinteraction" />
                        <label>Required (UI:R)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Scope</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssScope" value="S:U"
                          [(ngModel)]="newElement.cvssScope" />
                        <label>Unchanged (S:U)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssScope" value="S:C"
                          [(ngModel)]="newElement.cvssScope" />
                        <label>Changed (S:C)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Confidentiality</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssConfidentiality" value="C:N"
                          [(ngModel)]="newElement.cvssConfidentiality" />
                        <label>None (C:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssConfidentiality" value="C:L"
                          [(ngModel)]="newElement.cvssConfidentiality" />
                        <label>Low (C:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssConfidentiality" value="C:H"
                          [(ngModel)]="newElement.cvssConfidentiality" />
                        <label>High (C:H)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Integrity</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssIntegrity" value="I:N"
                          [(ngModel)]="newElement.cvssIntegrity" />
                        <label>None (I:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssIntegrity" value="I:L"
                          [(ngModel)]="newElement.cvssIntegrity" />
                        <label>Low (I:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssIntegrity" value="I:H"
                          [(ngModel)]="newElement.cvssIntegrity" />
                        <label>High (I:H)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Availability</clr-stack-label>
                  <clr-stack-content>
                    <clr-radio-container clrInline>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAvailability" value="A:N"
                          [(ngModel)]="newElement.cvssAvailability" />
                        <label>None (A:N)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAvailability" value="A:L"
                          [(ngModel)]="newElement.cvssAvailability" />
                        <label>Low (A:L)</label>
                      </clr-radio-wrapper>
                      <clr-radio-wrapper>
                        <input type="radio" (change)="calculateRisk()" clrRadio name="cvssAvailability" value="A:H"
                          [(ngModel)]="newElement.cvssAvailability" />
                        <label>High (A:H)</label>
                      </clr-radio-wrapper>
                    </clr-radio-container>
                  </clr-stack-content>
                </clr-stack-block>
              </clr-stack-block>
              <clr-stack-block [clrStackViewLevel]="1" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                <clr-stack-label>Temporal Score</clr-stack-label>
                <clr-stack-content>
                  <span class="badge badge-success"
                    *ngIf="temporalScore.rating == 'Low'"><b>{{temporalScore.rating}}</b></span>
                  <span class="badge badge-warning"
                    *ngIf="temporalScore.rating == 'Medium'"><b>{{temporalScore.rating}}</b></span>
                  <span class="badge badge-danger"
                    *ngIf="temporalScore.rating == 'High'"><b>{{temporalScore.rating}}</b></span>
                  <span class="badge badge-purple"
                    *ngIf="temporalScore.rating == 'Critical'"><b>{{temporalScore.rating}}</b></span>
                </clr-stack-content>
                <clr-stack-content><span [ngClass]="getClass(totalScore.rating)"><b>{{totalScore.rating}}</b></span>
                </clr-stack-content>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="1">
                  <clr-stack-label>Exploitability</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssExploitability"
                      [(ngModel)]="newElement.cvssExploitability">
                      <option value="E:X">Not Defined</option>
                      <option value="E:U">Unproven that exploit exists</option>
                      <option value="E:P">Proof of concept code</option>
                      <option value="E:F">Functional exploit exists</option>
                      <option value="E:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Remediation Level</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssRemediation_level"
                      [(ngModel)]="newElement.cvssRemediation_level">
                      <option value="RL:X">Not Defined</option>
                      <option value="RL:O">Official fix</option>
                      <option value="RL:T">Temporary fix</option>
                      <option value="RL:W">Workaround</option>
                      <option value="RL:U">Unavailable</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Report confidence</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssReportconfidence"
                      [(ngModel)]="newElement.cvssReportconfidence">
                      <option value="RC:X">Not Defined</option>
                      <option value="RC:U">Unknown</option>
                      <option value="RC:R">Reasonable</option>
                      <option value="RC:C">Confirmed</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
              </clr-stack-block>



              <clr-stack-block [clrStackViewLevel]="1" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                <clr-stack-label>Enviromental Score</clr-stack-label>
                <clr-stack-content><span [ngClass]="getClass(totalScore.rating)"><b>{{totalScore.rating}}</b></span>
                </clr-stack-content>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="1">
                  <clr-stack-label>Attack Vector</clr-stack-label>
                  <clr-stack-content>
                    <select clrSelect (change)="calculateRisk()" name="cvssEnviromentalAV"
                      [(ngModel)]="newElement.cvssEnviromentalAV">
                      <option value="MAV:X">Not Defined</option>
                      <option value="MAV:N">Network</option>
                      <option value="MAV:A">Adjacent Network</option>
                      <option value="MAV:L">Local</option>
                      <option value="MAV:P">Physical</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="3">
                  <clr-stack-label>Attack Complexity</clr-stack-label>
                  <clr-stack-content>
                    <select clrSelect (change)="calculateRisk()" name="cvssEnviromentalAC"
                      [(ngModel)]="newElement.cvssEnviromentalAC">
                      <option value="MAC:X">Not Defined</option>
                      <option value="MAC:L">Low</option>
                      <option value="MAC:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Privileges Required</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalPR"
                      [(ngModel)]="newElement.cvssEnviromentalPR">
                      <option value="MPR:X">Not Defined</option>
                      <option value="MPR:N">None</option>
                      <option value="MPR:L">Low</option>
                      <option value="MPR:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>User Interaction</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalUI"
                      [(ngModel)]="newElement.cvssEnviromentalUI">
                      <option value="MUI:X">Not Defined</option>
                      <option value="MUI:N">None</option>
                      <option value="MUI:R">Required</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Scope</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalS"
                      [(ngModel)]="newElement.cvssEnviromentalS">
                      <option value="MS:X">Not Defined</option>
                      <option value="MS:U">Unchanged</option>
                      <option value="MS:R">Changed</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Confidentiality Impact</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalCI"
                      [(ngModel)]="newElement.cvssEnviromentalCI">
                      <option value="MC:X">Not Defined</option>
                      <option value="MC:N">None</option>
                      <option value="MC:L">Low</option>
                      <option value="MC:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Integrity Impact</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalII"
                      [(ngModel)]="newElement.cvssEnviromentalII">
                      <option value="MI:X">Not Defined</option>
                      <option value="MI:N">None</option>
                      <option value="MI:L">Low</option>
                      <option value="MI:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Availability Impact</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalAI"
                      [(ngModel)]="newElement.cvssEnviromentalAI">
                      <option value="MA:X">Not Defined</option>
                      <option value="MA:N">None</option>
                      <option value="MA:L">Low</option>
                      <option value="MA:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Confidentiality Requirement</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalCR"
                      [(ngModel)]="newElement.cvssEnviromentalCR">
                      <option value="CR:X">Not Defined</option>
                      <option value="CR:L">Low</option>
                      <option value="CR:M">Medium</option>
                      <option value="CR:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Integrity Requirement</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalIR"
                      [(ngModel)]="newElement.cvssEnviromentalIR">
                      <option value="IR:X">Not Defined</option>
                      <option value="IR:L">Low</option>
                      <option value="IR:M">Medium</option>
                      <option value="IR:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>

                <clr-stack-block [clrStackViewLevel]="2" [clrStackViewSetsize]="3" [clrStackViewPosinset]="2">
                  <clr-stack-label>Availability Requirement</clr-stack-label>
                  <clr-stack-content>
                    <select (change)="calculateRisk()" clrSelect name="cvssEnviromentalAR"
                      [(ngModel)]="newElement.cvssEnviromentalAR">
                      <option value="AR:X">Not Defined</option>
                      <option value="AR:L">Low</option>
                      <option value="AR:M">Medium</option>
                      <option value="AR:H">High</option>
                    </select>
                  </clr-stack-content>
                </clr-stack-block>
              </clr-stack-block>
           </clr-stack-view>
          </div>
          <button (click)="create()" class="btn btn-outline">Add Vulnerability</button>
        </clr-tab-content>
      </ng-template>
    </clr-tab>
    <clr-tab>
      <button clrTabLink>Details</button>
      <ng-template [(clrIfActive)]="detailActive">
        <clr-tab-content>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-textarea-container>
                <label>Description<span style="color:red">*</span></label>
                <textarea rows="2" cols="60" clrTextarea [(ngModel)]="newElement.description"
                  name="description"></textarea>
              </clr-textarea-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-textarea-container>
                <label>Executed Test<span style="color:red">*</span></label>
                <textarea rows="2" cols="60" clrTextarea [(ngModel)]="newElement.executedTest"
                  name="executedTest"></textarea>
              </clr-textarea-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-textarea-container>
                <label>Recommendation<span style="color:red">*</span></label>
                <textarea rows="2" cols="60" clrTextarea [(ngModel)]="newElement.recommendation"
                  name="recommendation"></textarea>
              </clr-textarea-container>
            </div>
          </div>
          <div class="clr-row">
            <div class="clr-col-lg-auto">
              <clr-textarea-container>
                <label>Observations</label>
                <textarea rows="2" cols="60" clrTextarea [(ngModel)]="newElement.observations"
                  name="observations"></textarea>
              </clr-textarea-container>
            </div>
          </div>
          <button (click)="create()" class="btn btn-outline">Add Vulnerability</button>
        </clr-tab-content>
      </ng-template>
    </clr-tab>
  </clr-tabs>